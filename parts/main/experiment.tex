\section*{Численные эксперименты}
\addcontentsline{toc}{subsection}{Численные эксперименты}

Тестирование проводилось на компьютере со следующими характеристиками:

\begin{table}[h]
\centering
\begin{tabular}{| c | c |}
    \hline
    Частота процессора & 3.7 ГГц \\ \hline
    Архитектура & 64-битная \\ \hline
    Модель процессора & Intel(R) Xeon(R) CPU E5-1620 v2 \\ \hline
    Число ядер & 8 \\ \hline
    Оперативная память & 64 Гб \\ \hline
    Объём жёсткого диска & 300 Гб \\
    \hline
\end{tabular}
\caption{Характеристики оборудования,
на котором проводилось тестирование}
\end{table}

Старой реализацией будем называть
изначальную реализацию,
где для вычисления функционала
на векторе параметров запускался
новый интерпретатор и
заново происходила загрузка
данных о траекториях.

Новым вариантом реализации
будем называть реализацию,
где используется очередь задач
и пул потоков,
интерпретаторы инициализируются
один раз и не подвергаются перезапуску,
то есть время жизни интерпретатора
завершается с окончанием оптимизации.

План тестирования заключался
в сравнение времени работы
старой и новой реализаций
при одинаковых параметрах.
Проводились многократные запуски
с целью подтверждения или опровержения
гипотезы о статистической значимости различий
времени работы реализаций.
Под нулевой гипотезой будет пониматься
различие математического ожидания
старой и новой реализаций.

Первым этапом численного эксперимента
было получение замеров времени
работы приложения
при различных комбинациях параметров.
Проводилось по 100 запусков
для каждого набора параметров.

Параметрами были выбраны следующие характеристики:

\begin{itemize}
    \item \textbf{Число потоков (\textit{i})}

        Для новой реализации этот параметр также
        обозначал размер пула потоков.
        Диапазон значений: 1-8.
    \item \textbf{Коэффициент размера популяции (\textit{M})}

        Размер популяции рационально выбирать
        пропорционально числу потоков,
        чтобы на каждый поток приходилась
        равная нагрузка при различном
        числе \textit{i}.

        Таким образом размер популяции равен:
        \begin{math}M * i\end{math}

        Тестирование проходило для значений:
        \begin{math}M = 5; M = 10\end{math}.
\end{itemize}

\break
На рис.~\ref{fig:m5}, рис.~\ref{fig:m10} представлены результаты тестирования:

\begin{figure}[!h]
\centering
\includegraphics[width=0.74\textwidth]{m5}
\caption{Медиана и полтора межквартильных расстояния
времени выполнения при $M = 5$}
\label{fig:m5}
\end{figure}

\begin{figure}[!h]
\centering
\includegraphics[width=0.74\textwidth]{m10}
\caption{Медиана и полтора межквартильных расстояния
времени выполнения при $M = 10$}
\label{fig:m10}
\end{figure}

Такую существенную разницу во времени выполнения
можно объяснить большими накладными расходами
на инициализацию на каждой итерации алгоритма
нового экземпляра интерпретатора
и освобождения ресурсов от старого,
больше не используемого экземпляра.
По большому разбросу значений
старой реализации можно предположить,
что существовали проблемы с конкуренцией
за ресурсы при инициализации интерпретаторов,
которые в некоторых случаях приводили к
существенному общему замедлению выполнения программы.
Из рисунков видно,
что в новой реализации разброс существенно меньше.

Разработанный механизм обеспечивает
четырёхкратный прирост производительности
на четырёх параллельных потоках
с четырьмя интерпретаторами по
сравнению со старой реализацией.

Было проверено, оказывает ли изучаемый параметр,
в данном случае это новый вариант реализации,
существенное влияние на интересующую нас
переменную, на время работы.
Проверка осуществлялась с помощью
критерия достоверно значимой
разности Тьюки
с уровнем значимости в 95\%.
Он необходим, чтобы посмотреть
где именно лежат статистические различия.

\begin{figure}[!h]
\centering
\includegraphics[width=\textwidth]{tukey}
\caption{График 95\% доверительных интервалов,
построенных по критерию Тьюки.
Цветными рамками обозначены группы сравниваемых пар.
Старая и новая реализации имеют статистически
значимую разницу}
\label{fig:tukey}
\end{figure}

Пунктирной вертикальной линией на рис.~\ref{fig:tukey}
показана нулевая разница между групповыми средними времени.
Если доверительный интервал включает 0,
это указывает на отсутствие различий
между соответствующими группами.

На рис.~\ref{fig:tukey} выделены три группы цветными рамками:
\begin{itemize}
    \item \textbf{Интервалы внутри красной рамки (справа вверху)} ---
        пары групп старой реализации с различным числом интерпретаторов.
        Интервалы лежат возле нуля, но присутствует
        некоторое разница, как в положительную сторону,
        так и в отрицательную. Это может объясняться
        конкуренцией интерпретаторов
        за вычислительные ресурсы и доступом к конфигурационным файлам
        при их одновременной инициализации.
    \item \textbf{Интервалы внутри синей рамки (справа внизу)} ---
        пары групп новой реализации с различным числом интерпретаторов.
        В данной группе различия минимальны,
        что является свидетельством оптимизации.
        В новой реализации инициализация интерпретаторов
        происходит единожды, поэтому
        узкое место не сильно замедляет работу
        при конкуренции, в дальнейшем
        интерпретаторы не так конкурируют за ресурсы.
    \item \textbf{Интервалы внутри жёлтой рамки (слева)} ---
        смешанные группы новой и старой реализации.
        Разница статистически значима,
        это означает, что оптимизация играет существенную роль.
\end{itemize}

