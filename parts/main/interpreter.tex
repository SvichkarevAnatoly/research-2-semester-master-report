\section*{Улучшение взаимодействия.\\Встраивание интерпретаторов}
\addcontentsline{toc}{subsection}
{Улучшение взаимодействия. Встраивание интерпретаторов}

Математические модели для DEEP,
функционал которых необходимо минимизировать
создаются в таких компьютерных системах расчётов
как R, MATLAB, Octave
и других интерпретируемых языках программирования.
Это реализуется в виде внешнего скрипта,
который указывается DEEP в качестве входного параметра.
Нахождение параметров требует
многократного вычисления решений,
что влечёт большие накладные расходы
на запуск и инициализацию интерпретатора.

Однако интерпретатор может быть встроен в DEEP.
Это позволит использовать процессорное время вычислений
более эффективно благодаря
улучшению взаимодействия между
методом оптимизации и
функционалом качества.
В работе был спроектирован и реализован
подход с использованием
асинхронной очереди задач и пула потоков
из библиотеки GLib.
Преимуществом использования GLib
является её кроссплатформенность
и принадлежность к свободному программному обеспечению.

В конфигурационном файле был добавлен
параметр числа потоков в пуле потоков,
который указывается пользователем
при старте DEEP.

\textbf{Опишем более подробно ход выполнения программы
при новом подходе.}

После начальной инициализации DEEP
и генерации начальной популяции,
создаётся пул потоков,
число потоков в котором равно
указанному пользователем числу в
конфигурационном файле.
В каждом потоке параллельно
запускается свой интерпретатор того языка,
на котором была реализована математическая модель.
В каждый интерпретатор загружаются
функции из скрипта
для вычисления значения функционала
на векторе параметров индивида.
Так как запускается интерпретатор
с интерфейсом командной строки,
необходимо создать потоки ввода-вывода,
для связи интерпретаторов
с главным потоком исполнения,
которому необходимо получить
результаты вычислений со всех интерпретаторов.
Векторы индивидов из поколения популяции
образуют задачу и
добавляются в асинхронную очередь задач.
Свободный поток из пула потоков
выбирает из очереди первую задачу
и вызывает в своём потоке
исполнение вычисления функционала
на данном векторе в интерпретаторе.

После вычисления интерпретатор
возвращает результат в
выходной поток к главному потоку выполнения,
задача считается выполненной.
Свободный поток выбирает следующую задачу
и таким образом всё повторяется,
пока в очереди не закончатся задачи.
DEEP создаёт новое поколение популяции
и весь процесс повторяется,
либо до указанного числа итераций или
пока не будет достигнута сходимость
значений функционала.

Как указывалось выше,
используются структуры и алгоритмы
\textbf{GLib}\cite{GLib}:

\begin{itemize}
    \item \textbf{Thread Pool} --- пул потоков;
    \item \textbf{Asynchronous Queue} --- асинхронная очередь задач;
    \item \textbf{IO Channel} --- поток ввода-вывода;
\end{itemize}

